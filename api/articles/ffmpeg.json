{"title":"使用 PHP-FFMpeg 操作视频/音频文件","uid":"c84b6d5483d961b6dab0d4b33336d057","slug":"ffmpeg","date":"2021-07-29T09:30:00.000Z","updated":"2022-07-20T06:30:40.064Z","comments":true,"path":"api/articles/ffmpeg.json","keywords":"动漫 技术 thinkbim","cover":"https://cdn.jsdelivr.net/gh/ThinkBIM/CDN@V1.0/comic/pic_1.jpg","content":"<h1 id=\"使用-PHP-FFMpeg-操作视频-x2F-音频文件\"><a href=\"#使用-PHP-FFMpeg-操作视频-x2F-音频文件\" class=\"headerlink\" title=\"使用 PHP-FFMpeg 操作视频&#x2F;音频文件\"></a>使用 PHP-FFMpeg 操作视频&#x2F;音频文件</h1><h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><pre class=\"line-numbers language-composer\" data-language=\"composer\"><code class=\"language-composer\">composer require php-ffmpeg&#x2F;php-ffmpeg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"获取视频信息\"><a href=\"#获取视频信息\" class=\"headerlink\" title=\"获取视频信息\"></a>获取视频信息</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">\n<span class=\"token variable\">$url</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"视频地址\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//参数配置</span>\n<span class=\"token variable\">$mpegConf</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token string single-quoted-string\">'ffmpeg.binaries'</span> <span class=\"token operator\">=></span> <span class=\"token function\">env</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ffmpeg.ffmpeg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//ffmpeg bin目录</span>\n  <span class=\"token string single-quoted-string\">'ffprobe.binaries'</span> <span class=\"token operator\">=></span> <span class=\"token function\">env</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ffmpeg.ffprobe'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//ffprobe bin目录</span>\n  <span class=\"token string single-quoted-string\">'timeout'</span> <span class=\"token operator\">=></span> <span class=\"token number\">3600</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string single-quoted-string\">'ffmpeg.threads'</span> <span class=\"token operator\">=></span> <span class=\"token number\">12</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$ffmpeg</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">FFMpeg</span><span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$mpegConf</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$video</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$ffmpeg</span><span class=\"token operator\">-></span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//视频的视频信I（width, height, duration）</span>\n<span class=\"token variable\">$videoInfo</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$video</span><span class=\"token operator\">-></span><span class=\"token function\">getStreams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">videos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">Array</span>\n<span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">[</span>codec_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> h264\n    <span class=\"token punctuation\">[</span>codec_long_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token constant\">H</span><span class=\"token number\">.264</span> <span class=\"token operator\">/</span> <span class=\"token constant\">AVC</span> <span class=\"token operator\">/</span> <span class=\"token constant\">MPEG</span><span class=\"token operator\">-</span><span class=\"token number\">4</span> <span class=\"token constant\">AVC</span> <span class=\"token operator\">/</span> <span class=\"token constant\">MPEG</span><span class=\"token operator\">-</span><span class=\"token number\">4</span> part <span class=\"token number\">10</span>\n    <span class=\"token punctuation\">[</span>profile<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> High\n    <span class=\"token punctuation\">[</span>codec_type<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> video\n    <span class=\"token punctuation\">[</span>codec_tag_string<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> avc1\n    <span class=\"token punctuation\">[</span>codec_tag<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0x31637661</span>\n    <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">544</span>\n    <span class=\"token punctuation\">[</span>height<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">960</span>\n    <span class=\"token punctuation\">[</span>coded_width<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">544</span>\n    <span class=\"token punctuation\">[</span>coded_height<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">960</span>\n    <span class=\"token punctuation\">[</span>closed_captions<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">[</span>has_b_frames<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">[</span>pix_fmt<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> yuv420p\n    <span class=\"token punctuation\">[</span>level<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">31</span>\n    <span class=\"token punctuation\">[</span>color_range<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> tv\n    <span class=\"token punctuation\">[</span>color_space<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> bt709\n    <span class=\"token punctuation\">[</span>color_transfer<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> bt709\n    <span class=\"token punctuation\">[</span>color_primaries<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> bt709\n    <span class=\"token punctuation\">[</span>chroma_location<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> left\n    <span class=\"token punctuation\">[</span>refs<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">[</span>is_avc<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">true</span>\n    <span class=\"token punctuation\">[</span>nal_length_size<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">4</span>\n    <span class=\"token punctuation\">[</span>r_frame_rate<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">30</span><span class=\"token operator\">/</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">[</span>avg_frame_rate<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">30</span><span class=\"token operator\">/</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">[</span>time_base<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">600</span>\n    <span class=\"token punctuation\">[</span>start_pts<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">[</span>start_time<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0.000000</span>\n    <span class=\"token punctuation\">[</span>duration_ts<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">9000</span>\n    <span class=\"token punctuation\">[</span>duration<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">15.000000</span>\n    <span class=\"token punctuation\">[</span>bit_rate<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">1014409</span>\n    <span class=\"token punctuation\">[</span>bits_per_raw_sample<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">8</span>\n    <span class=\"token punctuation\">[</span>nb_frames<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">450</span>\n    <span class=\"token punctuation\">[</span>disposition<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">Array</span>\n        <span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">[</span><span class=\"token keyword\">default</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">1</span>\n            <span class=\"token punctuation\">[</span>dub<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>original<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>comment<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>lyrics<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>karaoke<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>forced<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>hearing_impaired<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>visual_impaired<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>clean_effects<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>attached_pic<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">[</span>timed_thumbnails<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n        <span class=\"token punctuation\">)</span>\n\n    <span class=\"token punctuation\">[</span>tags<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">Array</span>\n        <span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">[</span>creation_time<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">14</span>T01<span class=\"token punctuation\">:</span><span class=\"token number\">27</span><span class=\"token punctuation\">:</span><span class=\"token number\">05.000000</span>Z\n            <span class=\"token punctuation\">[</span>language<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> und\n            <span class=\"token punctuation\">[</span>handler_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> Core Media Video\n            <span class=\"token punctuation\">[</span>vendor_id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"获取视频大小\"><a href=\"#获取视频大小\" class=\"headerlink\" title=\"获取视频大小\"></a>获取视频大小</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">\n\n<span class=\"token variable\">$mpegConf</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token string single-quoted-string\">'ffmpeg.binaries'</span> <span class=\"token operator\">=></span> <span class=\"token function\">env</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ffmpeg.ffmpeg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string single-quoted-string\">'ffprobe.binaries'</span> <span class=\"token operator\">=></span> <span class=\"token function\">env</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'ffmpeg.ffprobe'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string single-quoted-string\">'timeout'</span> <span class=\"token operator\">=></span> <span class=\"token number\">3600</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string single-quoted-string\">'ffmpeg.threads'</span> <span class=\"token operator\">=></span> <span class=\"token number\">12</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$ffprobe</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">FFProbe</span><span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$mpegConf</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$videoInfo</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$ffprobe</span><span class=\"token operator\">-></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$remotefilename</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//获取视频大小</span>\n<span class=\"token variable\">$size</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$ffprobe</span><span class=\"token operator\">-></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$remotefilename</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'size'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//获取视频时长</span>\n<span class=\"token variable\">$duration</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$ffprobe</span><span class=\"token operator\">-></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$remotefilename</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'duration'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//! ---------videoInfo--------</span>\n<span class=\"token keyword\">Array</span>\n<span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span>filename<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token operator\">/</span>Desktop<span class=\"token operator\">/</span><span class=\"token number\">1618363630035895.</span>mp4\n    <span class=\"token punctuation\">[</span>nb_streams<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">2</span>\n    <span class=\"token punctuation\">[</span>nb_programs<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">[</span>format_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> mov<span class=\"token punctuation\">,</span>mp4<span class=\"token punctuation\">,</span>m4a<span class=\"token punctuation\">,</span><span class=\"token number\">3</span>gp<span class=\"token punctuation\">,</span><span class=\"token number\">3</span>g2<span class=\"token punctuation\">,</span>mj2\n    <span class=\"token punctuation\">[</span>format_long_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> QuickTime <span class=\"token operator\">/</span> <span class=\"token constant\">MOV</span>\n    <span class=\"token punctuation\">[</span>start_time<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">0.000000</span>\n    <span class=\"token punctuation\">[</span>duration<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">15.000000</span>\n    <span class=\"token punctuation\">[</span>size<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">2018388</span>\n    <span class=\"token punctuation\">[</span>bit_rate<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">1076473</span>\n    <span class=\"token punctuation\">[</span>probe_score<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">100</span>\n    <span class=\"token punctuation\">[</span>tags<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">Array</span>\n        <span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">[</span>major_brand<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> mp42\n            <span class=\"token punctuation\">[</span>minor_version<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">1</span>\n            <span class=\"token punctuation\">[</span>compatible_brands<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> isommp41mp42\n            <span class=\"token punctuation\">[</span>creation_time<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> <span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">04</span><span class=\"token operator\">-</span><span class=\"token number\">14</span>T01<span class=\"token punctuation\">:</span><span class=\"token number\">27</span><span class=\"token punctuation\">:</span><span class=\"token number\">05.000000</span>Z\n            <span class=\"token punctuation\">[</span>copyright<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> \n            <span class=\"token punctuation\">[</span>copyright<span class=\"token operator\">-</span>eng<span class=\"token punctuation\">]</span> <span class=\"token operator\">=></span> \n        <span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"视频截取\"><a href=\"#视频截取\" class=\"headerlink\" title=\"视频截取\"></a>视频截取</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">//tempnam创建一个具有唯一文件名的临时文件</span>\n<span class=\"token variable\">$localtempfilename</span> <span class=\"token operator\">=</span> <span class=\"token function\">tempnam</span><span class=\"token punctuation\">(</span><span class=\"token function\">ini_get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'upload_tmp_dir'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'hc-cover'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//截取视频，报错到临时文件</span>\n<span class=\"token variable\">$video</span><span class=\"token operator\">-></span><span class=\"token function\">frame</span><span class=\"token punctuation\">(</span><span class=\"token class-name static-context\">TimeCode</span><span class=\"token operator\">::</span><span class=\"token function\">fromSeconds</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$localtempfilename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//给指定文件的内容生成哈希值</span>\n<span class=\"token variable\">$videoCoverMd5</span> <span class=\"token operator\">=</span> <span class=\"token function\">hash_file</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'md5'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$localtempfilename</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'_0.jpg'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n\n\n<p><a href=\"https://blog.jam00.com/article/info/25.html\">参考资料</a></p>\n","text":"使用 PHP-FFMpeg 操作视频&#x2F;音频文件安装composer require php-ffmpeg&#x2F;php-ffmpeg 获取视频信息 $url = \"视频地址\"; //参数配置 $mpegConf = [ 'ffmpeg.binaries' => en...","link":"","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"PHP","slug":"PHP","count":1,"path":"api/categories/PHP.json"}],"tags":[{"name":"ffmpeg","slug":"ffmpeg","count":1,"path":"api/tags/ffmpeg.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8-PHP-FFMpeg-%E6%93%8D%E4%BD%9C%E8%A7%86%E9%A2%91-x2F-%E9%9F%B3%E9%A2%91%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">使用 PHP-FFMpeg 操作视频&#x2F;音频文件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">安装</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E8%A7%86%E9%A2%91%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">获取视频信息</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E8%A7%86%E9%A2%91%E5%A4%A7%E5%B0%8F\"><span class=\"toc-text\">获取视频大小</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A7%86%E9%A2%91%E6%88%AA%E5%8F%96\"><span class=\"toc-text\">视频截取</span></a></li></ol></li></ol>","author":{"name":"ThinkBIM","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/ThinkBIM/CDN@V1.0/logo.png","link":"/","description":"爱看动漫的技术菜鸟","socials":{"github":"https://github.com/ThinkBIM","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/thinkbim","zhihu":"https://www.zhihu.com/people/thinkbim","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Process","uid":"a9983badd6f0175985f109aa3bd52434","slug":"process","date":"2021-08-17T07:47:36.000Z","updated":"2022-07-20T06:30:40.064Z","comments":true,"path":"api/articles/process.json","keywords":"动漫 技术 thinkbim","cover":"https://cdn.jsdelivr.net/gh/ThinkBIM/CDN@V1.0/comic/pic_1.jpg","text":"进程 Process孤儿进程父进程不在了，子进程还在运行 僵尸进程一个进程使用fork创建子进程，如果子进程退出，而父进程并没有调用wait或waitpid获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中。这种进程称之为僵尸进程 守护进程后台服务进程 &amp; Po...","link":"","photos":[],"count_time":{"symbolsCount":172,"symbolsTime":"1 mins."},"categories":[{"name":"Go","slug":"Go","count":1,"path":"api/categories/Go.json"}],"tags":[],"author":{"name":"ThinkBIM","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/ThinkBIM/CDN@V1.0/logo.png","link":"/","description":"爱看动漫的技术菜鸟","socials":{"github":"https://github.com/ThinkBIM","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/thinkbim","zhihu":"https://www.zhihu.com/people/thinkbim","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Liunx问题总结","uid":"330d911a867eb710c7f804b3c058847c","slug":"liunx","date":"2021-07-22T01:47:36.000Z","updated":"2022-07-20T06:30:40.064Z","comments":true,"path":"api/articles/liunx.json","keywords":"动漫 技术 thinkbim","cover":"https://cdn.jsdelivr.net/gh/ThinkBIM/CDN@V1.0/comic/pic_1.jpg","text":"Liunx问题总结解决GitLab内存消耗大的问题 ","link":"","photos":[],"count_time":{"symbolsCount":26,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"ThinkBIM","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/ThinkBIM/CDN@V1.0/logo.png","link":"/","description":"爱看动漫的技术菜鸟","socials":{"github":"https://github.com/ThinkBIM","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/thinkbim","zhihu":"https://www.zhihu.com/people/thinkbim","csdn":"","juejin":"","customs":{}}}}}